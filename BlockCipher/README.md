# Блочные шифры 

Ссылка на видео https://youtu.be/PbDOmI1iM64

Так как болшая часть защиты задания на бонусные баллы это ответ на вопросы. Я по мере просмотра видео записывал вопросы которые возможно возникут. Чуть ниже сами вопросы и ответы на них

# Основные идеи видео

1. **Сложные шифры строятся на комбинации методов замены и транспозиции.** Автор поясняет, что по Шеннону для надёжного (пусть не абсолютного) шифра важно «хорошенько замешать и запутать» данные, комбинируя шифр замены и транспозиционный шифр.
2. **Абсолютно безопасный шифр (одноразовый блокнот) не практичен.** Для абсолютной секретности ключ должен быть не короче сообщения и использоваться только один раз. Из‑за этого одноразовый шифр невозможно эффективно применять для больших объёмов информации.
3. **Конструкция блочного шифра (ячейка Фейстеля).** Современные блочные шифры (например, DES и ГОСТ) разбивают блок данных на две половины, в каждой итерации применяя нелинейную функцию к одной половине и перекручивая результат XOR с другой. Многократное повторение (раунды) таких преобразований даёт высокий уровень запутанности (эффект лавины)
4. **Принцип лавины и надёжность.** После нескольких раундов изменение одного бита на входе влияет на все биты выхода. Такая стойкость к линейному и дифференциальному анализу (высокая нелинейность S-блоков) обеспечивает стойкость шифра.
5. **Режимы работы шифра.** В видео объясняется режим простой электронной кодовой книги (ECB), где каждый блок шифруется независимо. Показываются его недостатки (повторяющиеся блоки видны при шифровании изображений). Затем рассказывается о сцеплении блоков: CBC (цепочечный режим) и счётчике (CTR), где предыдущий шифр или счётчик смешиваются с открытым текстом для исчезновения шаблонов.
6. **Режим Electronic Code Book (ECB)** шифрует каждый блок независимо: его простота даёт параллелизм, но повторяющиеся блоки и шаблоны остаются видимыми, что делает ECB уязвимым к статистическому анализу, атакам повтором и подстановке по известным текстам. Похожим образом лингвисты переводили мертвые языки.

# Ответы на вопросы

1. **Что такое атака открытым текстом?** Это ситуация, когда злоумышленник может подставить (или узнать) некоторый открытый текст и получить соответствующий ему шифртекст. Зная пару открытый–шифртекст, он составляет таблицу соответствий и может восстановить правило шифрования. Например, Ева может попросить Алису зашифровать фразу по её выбору и по результату понять, как устроено шифрование.
2. **Что предложил Шеннон?** Шеннон сформулировал математические требования к шифру и подчеркнул принципы «замешивания» данных: шифрование должно сочетать замену (substitution) и перестановку (permutation) бит. Он рассматривал ключ, открытый и закрытый тексты как случайные величины и определял, какие статистические зависимости допустимы. Шеннон также показал, что для абсолютной секретности нужен ключ длиной не менее сообщения (одноразовый блокнот), что на практике неудобно.
3. **Что такое шифр замены и транспозиционный шифр?** *Шифр замены* — это алгоритм, в котором каждый символ (или блок бит) открытого текста заменяется на другой согласно некоторой таблице. Например, в шифре Цезаря каждая буква сдвигается на фиксированное число позиций. *Транспозиционный шифр* меняет порядок символов в тексте без их замены (например, переставляет буквы по определённой схеме). По Шеннону все классические шифры сводились к этим двум категориям.
4. **Что даёт их комбинация?** Комбинирование шифра замены и транспозиции (так называемый «продуктовый шифр») значительно усиливает защиту. Подстановка меняет символы, а перестановка перемешивает их, что вместе обеспечивает большую запутанность и затрудняет криптоанализ.
5. **Почему абсолютно надёжный шифр непрактичен?** Абсолютно надёжным считается шифр с ключом не короче сообщения (одноразовый блокнот). Такой ключ приходится хранить и передавать в секрете, причём он должен использоваться только один раз. Это практически невыполнимо для больших объёмов данных: если ключ повторяется хотя бы дважды, секретность теряется.
6. **Как построить хороший, надёжный шифр?** Надёжный шифр строят на многократном повторении простых, но взаимодополняющих шагов. Обычно используют структуру *Фейстеля*: разбивают блок на половины, применяют к одной половине нелинейную функцию с ключом и складывают по модулю 2 с другой половиной. Такой процесс повторяется в десятки раундов. Необходима сложная (нетривиальная) функция F (например, S-блоки), чтобы обеспечивать лавинный эффект: изменение одного бита на входе сильно меняет выход. Кроме того, шифр должен быть быстрым (десятки мегабит в секунду) и иметь большой размер ключа для защиты от грубой силы.
7. **Что такое моноалфавитный шифр?** Это шифр замены, где одна и та же таблица замены применяется ко всем символам сообщения. Каждый символ всегда заменяется одним и тем же символом. Пример – шифр Цезаря или любой простой заменяющий алфавит. Иными словами, один и тот же ключ используется для всего текста.
8. **Что такое ячейка Фейстеля?** Ячейка Фейстеля – это схема построения блочного шифра. В каждой итерации блок данных делится пополам: к правой половине применяется функция F, результат накладывается (XOR) на левую половину, затем стороны меняются местами. Такая структура гарантирует обратимость: для дешифрования достаточно запустить те же шаги в обратном порядке.
9. **Какие виды шифрования автор объяснил?**
    - **Классические шифры (подстановка и перестановка).** Разбирался простой моноалфавитный шифр (например, шифр Цезаря) и кратко упомянуто использование «кодовых книг» (электронный кодовая книга, где каждому слову соответствует код).
    - **Одноразовый блокнот.** Рассмотрен как пример абсолютно надёжного шифра: ключ настолько длинный, что каждый символ кода уникален. Именно оно даёт гарантию теоретической безопасности, но непрактично из-за длины ключа.
    - **Блочные шифры на ячейке Фейстеля.** Подробно объяснена схема DES (стандарт 1977 г.) и упомянут ГОСТ 28147-89. Описано разбиение на половины, раунды с функцией F, использование S-блоков и ключей раундов. Приведена история изменения DES: добавлены свои S-блоки NSA, после чего он противостоял дифференциальному анализу. Упомянуты размеры ключей (56 бит у DES, 256 бит у ГОСТ).
    - **Режимы связывания блоков.** Рассмотрены режим простой электронной кодовой книги (ECB) и его проблемы (повтор текста виден, атака повтором). Описан режим CBC (Cipher Block Chaining), где шифр предыдущего блока складывается с открытым текстом следующего, и режим счётчика (CTR), где к последовательно увеличивающемуся числу (счётчику) применяется шифрование и результат XORится с открытым текстом. Показывается, что эти режимы скрывают повторяющиеся паттерны и позволяют распараллеливать шифрование.
    - **Усиленные подходы 90-х.** Объяснено введение тройного шифрования (Triple DES) при двух ключах (второй проход выполняется в режиме дешифрования)  и запуск конкурса по выбору нового стандарта (AES) . Эти меры появились из-за роста вычислительных мощностей, сокращающих время полного перебора ключей.
10. **Что такое блочный шифр?** Это шифр, который обрабатывает сообщение кусками (блоками) фиксированной длины (например, 64 бита) с помощью одного ключа. Для каждого блока используется та же шифрующая функция и один и тот же ключ .
11. **Что важно для блочного шифра?** Главные характеристики:
    - **Сильная нелинейность (S-блоки).** Выходная функция должна быть устойчива к линейному и дифференциальному анализу: изменение одного бита на входе (особенно в нелинейном компоненте) должно менять примерно половину выходных бит .
    - **Лавинный эффект.** Малое изменение во входе должно давать большой эффект по выходу  . Это скрывает статистику и предотвращает дешифрование по шаблонам.
    - **Достаточное число раундов.** Шифрование повторяется множество раз (например, 16–32 раундов) , что гарантирует полное «перемешивание» битов.
    - **Производительность.** Шифр должен быть быстрым: современные блоковые шифры способны обрабатывать десятки мегабит в секунду без заметного замедления системы .
12.  **Что такое лавинный эффект и зачем он нужен?** Лавинный эффект — свойство шифра, при котором изменение одного бита входных данных или ключа приводит к изменению примерно половины битов выходных данных. Это критично для безопасности: оно гарантирует, что мелкая разница в открытом тексте или ключе полностью меняет шифртекст, что скрывает любые закономерности и делает атаки, основанные на статистике, неэффективными  .
13. **Какие атаки существуют против моноалфавитных шифров?** В первую очередь это **частотный (статистический) криптоанализ**: анализ частот букв и слов в зашифрованном тексте позволяет восстановить подстановочную таблицу . Также возможна атака по известному открытому тексту: если удаётся подобрать понятную фразу и получить её шифртекст, можно легко узнать, какой замене отвечает каждая буква . Криптографические словарные атаки (для шифров с кодовыми книгами) также возможны, но ключевым является именно анализ частот.
14. **Как работает атака открытым текстом?** Злоумышленник получает пару «открытый–закрытый текст». Например, он заставляет шифрующую машину зашифровать известную фразу. Затем он составляет таблицу соответствий между исходными и зашифрованными данными . С достаточным количеством таких пар можно полностью восстановить правило шифрования или ключ. В видео приводится пример: достаточно одной фразы из ~33 букв (известная «фраза Екатерины») для вскрытия произвольного моноалфавитного шифра .
15. **Как стали защищать шифры в 90-х из-за роста мощности ПК?** Возросшая скорость компьютеров сделала многие шифры (с относительным небольшим ключом) уязвимыми к полному перебору. Ответ был следующим: увеличивать ключи и применять многократное шифрование. Например, из-за устаревания 56-битного ключа DES перешли на тройное шифрование (Triple DES) . США объявили конкурс на новый стандарт шифрования (победил AES) . В результате современные алгоритмы (AES, современные версии ГОСТ) используют более длинные ключи и более сложные преобразования, устойчивые к современным атакам.
16. **Почему AES** выиграл конкурс разработки новых видов шифрования: одна из причин в том что AES не основан на ячейке Фейстеля. 

## Шифры DES и GOST

DES и GOST — классические блочные шифры на Feistel-сети с 64-битным блоком, но различаются длиной ключа (56 бит у DES против 256 бит у GOST), числом раундов (16 vs 32) и строением функции раунда. 

---

## Сравнение DES и GOST

| Характеристика | DES | GOST (Magma) |
| --- | --- | --- |
| **Block size** | 64 бит  | 64 бит  |
| **Key size** | 56 бит (8 паритетных)  | 256 бит (секретные S-блоки могут давать до 610 бит)  ([GOST (block cipher) |
| **Structure** | Сбалансированная Feistel-сеть, 16 раундов  | Feistel-сеть, 32 раунда  ([GOST (block cipher) |
| **Раунд-функция F** | Расширение до 48 бит, 8 S-блоков (6→4 бит), P-перестановка  | Сложение мод 2³² с субключом, 8 S-блоков (4→4 бит), циклический сдвиг на 11 бит  ([GOST (block cipher) |
| **Стандарт** | FIPS 46-3 (1977)  | GOST 28147-89 (1989), ревизия R 34.12-2015 (Magma)  |
| **Вычислительная сложность атаки** | Перебор 2⁵⁶ (практически за сутки на FPGA)  | Теоретические атаки до ~2¹⁹²; практических взломов нет  ([GOST (block cipher) |

---

## Подробнее про Electronic Code Book (ECB)

### Как работает

ECB разбивает сообщение на независимые блоки фиксированной длины и шифрует каждый блок отдельно.

### Минусы и уязвимости

1. **Повторяющиеся блоки → одинаковый шифртекст.** Шаблоны исходных данных не скрываются.
2. **Статистический криптоанализ.** Анализ частот повторяющихся блоков позволяет восстановить части кода или семантику данных.
3. **Атака по открытому тексту (codebook attack).** Злоумышленник может получить таблицу и подставлять известные блоки, чтобы узнать содержимое или повторно зашифровать данные.
4. **Отсутствие целостности.** Манипуляция отдельным блоком не нарушает расшифровку других: возможны атаки подмены и повторов (replay).
5. **Наглядный пример:** зашифрованное изображение в ECB сохраняет контуры (penguin) и легко узнаётся.

---

Для реальных приложений ECB практически не используется из-за уязвимости к анализу и подменам. Вместо него применяют сцепление блоков (CBC, CTR и др.), обеспечивающее скрытие паттернов и защиту от replay-атак.

## Вывод

Надёжный шифр строится «по частям» — от базовых подстановок до сложных схем с десятками раундов. Принципы, заложенные Шенноном (микширование данных, математическое описание шифра), всё ещё актуальны. 

И хотя абсолютной безопасности не достичь на практике, грамотное сочетание методов позволяет создавать шифры, которые практически невозможно взломать современными методами. 

Еще стоит учесть факт того, что одна из целей защиты это не “сделать непреступную крепость” потому что это невозможно в практике, а сделать так чтобы “атака была не целесобразна с пактической и финансовой точки зрения”. 

Всегда имеются разлиные практические ограничения. Даже если их нет слабым звеном может оказаться человек, пример того же фильма “Игра в иммитацию”. Где первые 5 случайных символов шифра оказались именем девушки солдата-связиста что в последствии было использовано для взлома шифра. 

## Глоссарий

**Атака по открытому тексту (known-plaintext attack)** – когда злоумышленник знает или подбирает часть исходного (открытого) текста и видит соответствующий ему шифртекст. По этим данным он пытается восстановить правило шифрования или ключ.

**Шифр замены (substitution cipher)** – шифр, где каждый символ или блок символов заменяется другим по фиксированному правилу. Например, шифр Цезаря сдвигает буквы алфавита на несколько позиций.

**Транспозиционный шифр (transposition cipher)** – шифр, который просто переставляет символы открытого текста (меняет их местами) без их замены. Пример: разбиение текста на строки и считывание по столбцам.

**Моноалфавитный шифр (monoalphabetic cipher)** – частный случай шифра замены, где используется один алфавит подстановки для всего текста. Каждый символ всегда заменяется одним и тем же символом шифр-алфавита.

**Ячейка Фейстеля (Feistel network)** – структура блочного шифра, где блок данных делится на левую и правую половины. На каждой итерации к правой половине применяется функция F и результат XOR-ится с левой половиной, после чего стороны меняются местами. Это обеспечивает обратимость шифра.

**Блочный шифр (block cipher)** – алгоритм шифрования, который обрабатывает данные «блоками» фиксированной длины (например, 64 или 128 бит) целиком. Для всех блоков используется один и тот же ключ и алгоритм.

**Эффект лавины (avalanche effect)** – свойство шифра, когда при изменении одного бита на входе примерно половина битов выходного шифротекста меняется. Благодаря этому маленькие изменения в исходном тексте приводят к «большому» изменению результата, что скрывает закономерности.

**Режим простой электронной кодовой книги (ECB)** – способ шифрования, при котором каждый блок шифруется независимо тем же ключом. Простой, но небезопасный режим: повторяющиеся блоки открытого текста дают повторяющиеся блоки шифр-текста.

**Режим цепочечного сцепления (CBC)** – режим шифрования, где перед шифрованием каждый открытый блок складывается (XOR) с результатом шифрования предыдущего блока. Таким образом одинаковые блоки шифруются по-разному, зависит от предыдущего шифротекста.

**Режим счётчика (CTR)** – режим, при котором к каждому блоку открытого текста применяется результат шифрования некоторого счётчика (обычно возрастающего числа). Это позволяет шифровать блоки параллельно и защищает от повторов, так как каждый блок «помечен» уникальным номером.